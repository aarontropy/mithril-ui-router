/*! 2015-04-25 */

!function(m){"use strict";function $listen(){var listener="hash"===mx.route.mode?"onhashchange":"onpopstate";window[listener]=function(){var url="hash"===mx.route.mode?window.location[mx.route.mode].substr(1):window.location[mx.route.mode];if(url!==currentUrl){var foundState=$findState(url);mx.route.go(foundState.state,foundState.parameters)}},window[listener]()}function $findState(url){for(var state in routes){var splitState=state.split("."),runningState="",runningUrl="";splitState.forEach(function(partialState){runningState=runningState?runningState+"."+partialState:partialState;var configurationUrl=routes[runningState].url;runningUrl=configurationUrl?runningUrl+configurationUrl:runningUrl});var instanceParameters=$instantiateUrlWith(runningUrl,url);if(instanceParameters)return{state:runningState,parameters:instanceParameters}}return{state:defaultState,parameters:{}}}function $instantiateUrlWith(fromUrl,toUrl){var splitFromUrl=fromUrl.split("/"),splitToUrl=toUrl.split("/"),parameters={};if(splitFromUrl.length!==splitToUrl.length)return!1;for(var i=0;i<splitFromUrl.length;i++)splitFromUrl[i]!==splitToUrl[i]&&":"===splitFromUrl[i][0]&&(parameters[splitFromUrl[i].substr(1)]=splitToUrl[i]);return parameters}window.mx=window.mx||{};var defaultState,currentState,currentStateParams,currentUrl,app,routes,validators={string:function(string){if("string"!=typeof string)throw new TypeError("a string is expected, but "+string+" ["+typeof string+"] given");return string},plainObject:function(object){if("object"!=typeof object)throw new TypeError("an object is expected, but "+object+"  ["+typeof object+"] given");return object}};mx.route=function(_app_,_defaultState_,_routes_){app=validators.plainObject(_app_),defaultState=validators.string(_defaultState_),routes=validators.plainObject(_routes_),$listen()},mx.route.go=function(_state_,_params_){if(validators.string(_state_),currentState){var onExit=routes[currentState].onExit;onExit&&onExit()}var splitState=_state_.split("."),runningState="",runningPlace=document,runningUrl="";currentStateParams=_params_,splitState.forEach(function(partialState){runningState=runningState?runningState+"."+partialState:partialState;var configuration=routes[runningState],module=$module(configuration.module),place=runningPlace.querySelector("#"+configuration.place),places=configuration.places,url=configuration.url,onEnter=configuration.onEnter;if(runningPlace=place||runningPlace,runningUrl=url?runningUrl+url:runningUrl,!currentState||-1===currentState.indexOf(runningState)||runningState===_state_){if(place)mx.route.$install(place,module),runningState!==_state_&&m.redraw(!0);else if(places){for(var key in places)module=$module(places[key]),place=runningPlace.querySelector("#"+key),mx.route.$install(place,module);runningState!==_state_&&m.redraw(!0)}onEnter&&onEnter()}}),currentState=_state_;for(var key in _params_)runningUrl=runningUrl.replace(":"+key,_params_[key]);currentUrl=window.location[mx.route.mode]=runningUrl},mx.route.current=function(){return currentState},mx.route.param=function(_key_){return validators.string(_key_),currentStateParams=currentStateParams||{},currentStateParams[_key_]},mx.route.mode="hash",mx.route.$install=function(place,module){m.module(place,module)};var $module=function(_path_){validators.string(_path_);var result=app,splitPath=_path_.split(".");return splitPath.forEach(function(pathPart){result=result[pathPart]}),result}}(m);
//# sourceMappingURL=dist/mithril-ui-router.js.map